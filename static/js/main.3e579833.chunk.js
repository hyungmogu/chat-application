(this["webpackJsonpchat-application"]=this["webpackJsonpchat-application"]||[]).push([[0],{118:function(n,e,t){"use strict";t.r(e);var a,r,c,i,o=t(27),s=t(2),l=t.n(s),u=t(77),d=t.n(u),b=(t(95),t(96),t(32)),j=t(14),p=t(78),m=t(62),O=t(18),g=t(6),h=t(7),x=t(13),f=t(49),v=t(50),y=t(3),w="#EEEEEE",F={Button:h.a.button(a||(a=Object(g.a)(["\n        border: none;\n        background-color: white;\n        font-size: 1.5em;\n        text-decoration: none;\n        color: ",";\n        padding: 0.5em;\n        margin: 0.5em;\n        cursor: pointer;\n\n        &:disabled {\n            opacity: 0.8;\n        }\n    "])),"#FFA341")};function k(n){return Object(y.jsx)(F.Button,{onClick:n.onClick,disabled:n.disabled,children:Object(y.jsx)(f.a,{icon:v.a})})}var S={Div:h.a.div(r||(r=Object(g.a)(["\n        background-color: ",";\n        padding: 1em;\n        border-radius: 5em;\n        display:flex;\n        flex-grow: 1;\n    "])),w),Textarea:h.a.textarea(c||(c=Object(g.a)(["\n        border: none;\n        resize: none;\n        width: 100%;\n        background-color: ",";\n        text-decoration: none;\n        padding: 1em;\n        overflow-y: scroll;\n\n        &:focus {\n            outline: none;\n        }\n    "])),w)};function E(n){return Object(y.jsx)(S.Div,{children:Object(y.jsx)(S.Textarea,{value:n.value,onChange:n.onChange})})}var C=Object(x.gql)(i||(i=Object(g.a)(["\n    mutation PostMutation(\n        $texts: String!\n    ) {\n        post(texts: $texts) {\n            id\n            postedBy {\n            id,\n                username\n            }\n            texts\n        }\n    }\n"])));function A(n){var e=Object(s.useState)(""),t=Object(O.a)(e,2),a=t[0],r=t[1],c=Object(x.useMutation)(C,{variables:{texts:a},onCompleted:function(n){r("")},onError:function(n){alert("Error occured")}}),i=Object(O.a)(c,1)[0];return Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)(E,{value:a,onChange:function(n){return r(n.target.value)}}),Object(y.jsx)(k,{onClick:i,disabled:!function(n){return!(!n||""===n.trim())}(a)})]})}var T,B,D,U,M=t(84),I=t(85),N=t(90),q=t(89),P={Div:h.a.div(T||(T=Object(g.a)(["\n        display: flex;\n        justify-content: ",";\n    "])),(function(n){return n.isCurrentUser?"flex-end":"initial"})),Section:h.a.section(B||(B=Object(g.a)(["\n        margin: 0;\n        background-color: ",";\n        padding: 1em;\n        border-radius: 1.5em;\n        max-width: 12em;\n        font-size: 0.8em;\n        white-space: pre-wrap;\n    "])),"#FFA341"),Header:h.a.header(D||(D=Object(g.a)(["\n        font-size: 0.7em;\n        padding: 0.5em 1em;\n    "])))};function z(n){var e=n.texts.split("\n").map((function(n){return Object(y.jsx)("p",{children:n})})),t=localStorage.getItem("USERNAME");return Object(y.jsx)(P.Div,{isCurrentUser:n.postedBy.username===t,children:Object(y.jsxs)("article",{children:[Object(y.jsx)(P.Header,{children:Object(y.jsx)("span",{children:n.postedBy.username})}),Object(y.jsx)(P.Section,{children:e})]})})}function R(n){return n.chats.map((function(n){return Object(y.jsx)(z,Object(o.a)({},n),n.id)}))}var $,L,H,K,_,Q={Section:h.a.section(U||(U=Object(g.a)(["\n        flex-grow: 1;\n        overflow-y: scroll;\n        padding: 1em;\n    "])))},J=function(n){Object(N.a)(t,n);var e=Object(q.a)(t);function t(n){var a;return Object(M.a)(this,t),(a=e.call(this,n)).scrollToBottom=function(){a.scrollToBottomRef.current.scrollIntoView({behavior:"auto"})},a.scrollToBottomRef=l.a.createRef(),a}return Object(I.a)(t,[{key:"componentDidMount",value:function(){this.scrollToBottom()}},{key:"componentDidUpdate",value:function(){this.scrollToBottom()}},{key:"render",value:function(){return Object(y.jsxs)(Q.Section,{ref:this.sectionRef,children:[Object(y.jsx)(R,{chats:this.props.chats}),Object(y.jsx)("div",{ref:this.scrollToBottomRef})]})}}]),t}(s.Component),V="#FFA341",G=Object(x.gql)($||($=Object(g.a)(["\n  mutation LogoutMutation {\n    logout {\n      id\n      username\n      loggedIn\n    }\n  }\n"]))),W={Button:h.a.button(L||(L=Object(g.a)(["\n        border: none;\n        background-color: ",";\n        font-size: 0.8em;\n        text-decoration: none;\n        color: ",";\n        padding: 0.5em 1em;\n        margin: 0.5em;\n        cursor: pointer;\n        border-radius: 5em;\n\n        &:disabled {\n            opacity: 0.8;\n        }\n    "])),"#FFFFFF",V)};function X(){var n=Object(j.f)(),e=Object(x.useMutation)(G,{onCompleted:function(e){localStorage.clear(),n.push("/")}}),t=Object(O.a)(e,1)[0];return Object(y.jsx)(W.Button,{onClick:t,children:"Logout"})}var Y,Z,nn,en,tn,an={Button:h.a.button(H||(H=Object(g.a)(["\n        background-color: transparent;\n        border: none;\n        padding: 0.5em;\n        cursor: pointer;\n        visibility: initial;\n\n        @media only screen and (min-width: 850px) {\n            visibility: hidden;\n        }\n    "]))),Nav:h.a.nav(K||(K=Object(g.a)(["\n        padding: 0.39em 0.75em;\n        background-color: ",";\n        display: flex;\n        align-items: center;\n        justify-content: space-between;\n    "])),V),Div:h.a.div(_||(_=Object(g.a)(["\n        background-color: white;\n        width: 1.75em;\n        height: 0.12em;\n        margin-bottom: 0.4em;\n\n        &:last-child {\n            margin: 0;\n        }\n    "])))};function rn(n){return Object(y.jsxs)(an.Nav,{children:[Object(y.jsxs)(an.Button,{onClick:n.onClick,children:[Object(y.jsx)(an.Div,{}),Object(y.jsx)(an.Div,{}),Object(y.jsx)(an.Div,{})]}),Object(y.jsx)(X,{})]})}var cn="#EEEEEE",on="3.30em",sn={Ul:h.a.ul(Y||(Y=Object(g.a)(["\n        list-style: none;\n        padding: 0;\n        margin: 0;\n        height: calc(100vh - ",");\n        width: 15em;\n        box-shadow: 2px 0px ",";\n        display: none;\n\n        @media only screen and (min-width: 850px) {\n            display: initial;\n        }\n    "])),on,cn)};function ln(n){var e=localStorage.getItem("USERNAME"),t=n.users.map((function(n){return Object(y.jsx)(fn,Object(o.a)(Object(o.a)({},n),{},{isOwner:e===n.username}),n.id)}));return Object(y.jsx)(sn.Ul,{children:t})}var un={Ul:h.a.ul(Z||(Z=Object(g.a)(["\n        list-style: none;\n        padding: 0;\n        margin: 0;\n        height: calc(100vh - ",");\n        width: 15em;\n        box-shadow: 2px 0px ",";\n        display: ",";\n\n        @media only screen and (min-width: 850px) {\n            display: none;\n        }\n    "])),on,cn,(function(n){return n.toggled?"initial":"none"}))};function dn(n){var e=localStorage.getItem("USERNAME"),t=n.users.map((function(n){return Object(y.jsx)(fn,Object(o.a)(Object(o.a)({},n),{},{isOwner:e===n.username}),n.id)}));return Object(y.jsx)(un.Ul,{toggled:n.toggled,children:t})}var bn,jn,pn,mn,On,gn,hn,xn={Div:h.a.div(nn||(nn=Object(g.a)(["\n        color: ",";\n        background-color: ",";\n        padding: 0.8em;\n        display: inline-block;\n        border-radius: 50%;\n        margin-right: 1em;\n\n        div {\n            width: 1.25em;\n            height: 1.25em;\n            display: flex;\n            justify-content: center;\n            align-items: center;\n        }\n    "])),"#FFFFFF","#FFA341"),Span:h.a.span(en||(en=Object(g.a)(["\n        font-size: 0.8em;\n    "]))),Li:h.a.li(tn||(tn=Object(g.a)(["\n        display: flex;\n        align-items: center;\n        padding: 0.5em 1em;\n    "])))};function fn(n){return Object(y.jsxs)(xn.Li,{children:[Object(y.jsx)(xn.Div,{children:Object(y.jsx)("div",{children:Object(y.jsx)(f.a,{icon:v.b})})}),Object(y.jsxs)(xn.Span,{children:[n.username," ",n.isOwner?"(Me)":""]})]})}var vn=h.a.div(bn||(bn=Object(g.a)(["\n    display: flex;\n"]))),yn=h.a.section(jn||(jn=Object(g.a)(["\n    height: calc(100vh - ",");\n    display: flex;\n    flex-direction: column;\n    flex-grow: 1;\n"])),"3.30em"),wn=h.a.section(pn||(pn=Object(g.a)(["\n    display: flex;\n    padding: 1em;\n"]))),Fn=Object(x.gql)(mn||(mn=Object(g.a)(["\n  query {\n    participants {\n      id,\n      username\n    },\n    chats {\n      id,\n      postedBy {\n        username\n      },\n      texts\n    }\n  }\n"]))),kn=Object(x.gql)(On||(On=Object(g.a)(["\n  subscription {\n    newChat {\n      id\n      texts\n      postedBy {\n        id\n        username\n      }\n    }\n  }\n"]))),Sn=Object(x.gql)(gn||(gn=Object(g.a)(["\n  subscription {\n    newParticipant {\n      id\n      username\n    }\n  }\n"]))),En=Object(x.gql)(hn||(hn=Object(g.a)(["\n  subscription {\n    removeParticipant {\n      id\n      username\n    }\n  }\n"])));var Cn,An,Tn,Bn,Dn,Un,Mn,In,Nn=function(){var n,e,t=Object(j.f)(),a=Object(s.useState)(!1),r=Object(O.a)(a,2),c=r[0],i=r[1];Object(s.useEffect)((function(n){var e=localStorage.getItem("USERNAME"),a=localStorage.getItem("AUTH_TOKEN");e&&a||t.push("/")}));var o=Object(x.useQuery)(Fn),l=o.data,u=o.subscribeToMore;return n=l&&l.chats?l.chats:[],e=l&&l.participants?l.participants:[],u({document:kn,updateQuery:function(n,e){var t=e.subscriptionData;if(!t.data)return n;var a=t.data.newChat;return n.chats.find((function(n){return n.id===a.id}))?n:Object.assign({},n,{chats:[].concat(Object(m.a)(n.chats),[a])})}}),u({document:Sn,updateQuery:function(n,e){var t=e.subscriptionData.data.newParticipant;return n.participants.find((function(n){return n.id===t.id}))?n:Object.assign({},n,{participants:[].concat(Object(m.a)(n.participants),[t])})}}),u({document:En,updateQuery:function(n,e){var t=[],a=e.subscriptionData.data.removeParticipant;if(!n.participants.find((function(n){return n.id===a.id})))return n;var r,c=Object(p.a)(n.participants);try{for(c.s();!(r=c.n()).done;){var i=r.value;i.id!==a.id&&t.push(i)}}catch(o){c.e(o)}finally{c.f()}return Object.assign({},n,{participants:t})}}),Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)(rn,{onClick:function(n){return i(!c)}}),Object(y.jsxs)(vn,{children:[Object(y.jsx)(ln,{users:e}),Object(y.jsx)(dn,{users:e,toggled:c}),Object(y.jsxs)(yn,{children:[Object(y.jsx)(J,{chats:n}),Object(y.jsx)(wn,{children:Object(y.jsx)(A,{})})]})]})]})},qn="#FFFFFF",Pn=h.a.section(Cn||(Cn=Object(g.a)(["\n  width: 100vw;\n  height: 100vh;\n  background-color: ",";\n  display: flex;\n  justify-content: center;\n  align-items: center;\n"])),"#FFA341"),zn=h.a.div(An||(An=Object(g.a)(["\n  color: ",";\n  width: 15em;\n  display: flex;\n  flex-direction: column;\n"])),qn),Rn=h.a.h1(Tn||(Tn=Object(g.a)(["\n  text-align: center;\n"]))),$n=h.a.form(Bn||(Bn=Object(g.a)(["\n  display: flex;\n  flex-direction: column;\n\n  & > * {\n    display: block;\n  }\n\n  & > * {\n    margin-bottom: 0.5em;\n  }\n\n  & > input:last-of-type {\n    margin-bottom: 1.5em;\n  }\n\n  & > *:last-child {\n    margin: 0;\n  }\n"]))),Ln=h.a.input(Dn||(Dn=Object(g.a)(["\n  padding: 1em;\n  border: none;\n  background-color: white;\n  border-radius: 5em;\n  text-align: center;\n\n  &:placeholder {\n      text-align: center;\n  }\n"]))),Hn=h.a.button(Un||(Un=Object(g.a)(["\n  padding: 1em;\n  border: none;\n  border-radius: 5em;\n  text-align: center;\n  cursor: pointer;\n  background-color: ",";\n  color: ",";\n  font-size: 0.8em;\n"])),"#9A4D31",qn),Kn=Object(h.a)(b.b)(Mn||(Mn=Object(g.a)(["\n  padding: 1em;\n  border: none;\n  border-radius: 5em;\n  text-align: center;\n  cursor: pointer;\n  background-color: ",";\n  font-size: 0.8em;\n  text-decoration: none;\n  color: black;\n"])),"#FFE24F"),_n=Object(x.gql)(In||(In=Object(g.a)(["\n  mutation LoginMutation(\n    $username: String!\n    $password: String!\n  ) {\n    login(\n      username: $username\n      password: $password\n    ) {\n      token\n      user {\n        username\n      }\n    }\n  }\n"])));var Qn,Jn,Vn,Gn,Wn,Xn,Yn,Zn,ne=function(){var n=Object(j.f)(),e=Object(s.useState)(""),t=Object(O.a)(e,2),a=t[0],r=t[1],c=Object(s.useState)(""),i=Object(O.a)(c,2),o=i[0],l=i[1],u=Object(x.useMutation)(_n,{variables:{username:a,password:o},onCompleted:function(e){var t=e.login;localStorage.setItem("AUTH_TOKEN",t.token),localStorage.setItem("USERNAME",t.user.username),n.push("/chat")},onError:function(n){console.log(n)}}),d=Object(O.a)(u,1)[0];return Object(y.jsx)(Pn,{children:Object(y.jsxs)(zn,{children:[Object(y.jsx)(Rn,{children:"Chat Application"}),Object(y.jsxs)($n,{children:[Object(y.jsx)(Ln,{type:"text",placeholder:"Username",value:a,onChange:function(n){return r(n.target.value)}}),Object(y.jsx)(Ln,{type:"password",placeholder:"Password",value:o,onChange:function(n){return l(n.target.value)}}),Object(y.jsx)(Hn,{type:"submit",onClick:function(n){n.preventDefault(),d()},disabled:!function(n,e){return!(!n||!e)&&(""!==n.trim()&&""!==e.trim())}(a,o),children:"Login"}),Object(y.jsx)(Kn,{to:"/signup",children:"Signup"})]})]})})},ee="#FFFFFF",te=h.a.section(Qn||(Qn=Object(g.a)(["\n  width: 100vw;\n  height: 100vh;\n  background-color: ",";\n  display: flex;\n  justify-content: center;\n  align-items: center;\n"])),"#FFA341"),ae=h.a.div(Jn||(Jn=Object(g.a)(["\n  color: ",";\n  width: 15em;\n  display: flex;\n  flex-direction: column;\n"])),ee),re=h.a.h1(Vn||(Vn=Object(g.a)(["\n  text-align: center;\n"]))),ce=h.a.form(Gn||(Gn=Object(g.a)(["\n  display: flex;\n  flex-direction: column;\n\n  & > * {\n    display: block;\n  }\n\n  & > * {\n    margin-bottom: 0.5em;\n  }\n\n  & > input:last-of-type {\n    margin-bottom: 1.5em;\n  }\n\n  & > *:last-child {\n    margin: 0;\n  }\n"]))),ie=h.a.input(Wn||(Wn=Object(g.a)(["\n  padding: 1em;\n  border: none;\n  background-color: white;\n  border-radius: 5em;\n  text-align: center;\n\n  &:placeholder {\n      text-align: center;\n  }\n"]))),oe=h.a.button(Xn||(Xn=Object(g.a)(["\n  padding: 1em;\n  border: none;\n  border-radius: 5em;\n  text-align: center;\n  cursor: pointer;\n  background-color: ",";\n  color: ",";\n  font-size: 0.8em;\n\n  &:disabled,\n  &[disabled]{\n    opacity: 0.6;\n  }\n"])),"#9A4D31",ee),se=Object(h.a)(b.b)(Yn||(Yn=Object(g.a)(["\n  padding: 1em;\n  border: none;\n  border-radius: 5em;\n  text-align: center;\n  cursor: pointer;\n  background-color: ",";\n  font-size: 0.8em;\n  text-decoration: none;\n  color: black;\n"])),"#FFE24F"),le=Object(x.gql)(Zn||(Zn=Object(g.a)(["\n  mutation SignupMutation(\n    $username: String!\n    $password: String!\n  ) {\n    signup(\n      username: $username\n      password: $password\n    ) {\n      token\n      user {\n        username\n      }\n    }\n  }\n"])));var ue=function(n){var e=Object(j.f)(),t=Object(s.useState)(""),a=Object(O.a)(t,2),r=a[0],c=a[1],i=Object(s.useState)(""),o=Object(O.a)(i,2),l=o[0],u=o[1],d=Object(s.useState)(""),b=Object(O.a)(d,2),p=b[0],m=b[1],g=Object(x.useMutation)(le,{variables:{username:r,password:l},onCompleted:function(n){var t=n.signup;localStorage.setItem("AUTH_TOKEN",t.token),localStorage.setItem("USERNAME",t.user.username),e.push("/chat")}}),h=Object(O.a)(g,1)[0];return Object(y.jsx)(te,{children:Object(y.jsxs)(ae,{children:[Object(y.jsx)(re,{children:"Chat Application"}),Object(y.jsxs)(ce,{children:[Object(y.jsx)(ie,{type:"text",placeholder:"Username",value:r,onChange:function(n){return c(n.target.value)}}),Object(y.jsx)(ie,{type:"password",placeholder:"Password",value:l,onChange:function(n){return u(n.target.value)}}),Object(y.jsx)(ie,{type:"password",placeholder:"Password Confirm",value:p,onChange:function(n){return m(n.target.value)}}),Object(y.jsx)(oe,{type:"submit",onClick:function(n){n.preventDefault(),h()},disabled:!function(n,e,t){return!!(n&&e&&t)&&(""!==n.trim()&&(""!==e.trim()&&(""!==t.trim()&&e.value===t.value)))}(r,l,p),children:"Signup"}),Object(y.jsx)(se,{to:"/",children:"Back"})]})]})})};var de=function(){return Object(y.jsx)(b.a,{children:Object(y.jsx)("main",{className:"App",children:Object(y.jsxs)(j.c,{children:[Object(y.jsx)(j.a,{path:"/chat",component:Nn}),Object(y.jsx)(j.a,{exact:!0,path:"/signup",component:ue}),Object(y.jsx)(j.a,{exact:!0,path:"/",component:ne})]})})})},be=function(n){n&&n instanceof Function&&t.e(3).then(t.bind(null,119)).then((function(e){var t=e.getCLS,a=e.getFID,r=e.getFCP,c=e.getLCP,i=e.getTTFB;t(n),a(n),r(n),c(n),i(n)}))},je=t(86),pe=t(87),me=t(1),Oe=Object(x.createHttpLink)({uri:"https://chat-application-hyungmogu.herokuapp.com/"}),ge=Object(je.a)((function(n,e){var t=e.headers,a=localStorage.getItem("AUTH_TOKEN");return{headers:Object(o.a)(Object(o.a)({},t),{},{authorization:a?"Bearer ".concat(a):""})}})),he=new pe.a({uri:"wss://chat-application-hyungmogu.herokuapp.com/graphql",options:{reconnect:!0,connectionParams:{authToken:localStorage.getItem("AUTH_TOKEN")}}}),xe=Object(x.split)((function(n){var e=n.query,t=Object(me.q)(e),a=t.kind,r=t.operation;return"OperationDefinition"===a&&"subscription"===r}),he,ge.concat(Oe)),fe=new x.ApolloClient({link:xe,cache:new x.InMemoryCache});d.a.render(Object(y.jsx)(l.a.StrictMode,{children:Object(y.jsx)(x.ApolloProvider,{client:fe,children:Object(y.jsx)(de,{})})}),document.getElementById("root")),be()},95:function(n,e,t){},96:function(n,e,t){}},[[118,1,2]]]);
//# sourceMappingURL=main.3e579833.chunk.js.map